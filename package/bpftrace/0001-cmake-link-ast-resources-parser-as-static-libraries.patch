From 960d2b69975462e445733482ac8d6ea319d3c5b2 Mon Sep 17 00:00:00 2001
From: Romain Naour <romain.naour@gmail.com>
Date: Thu, 5 Nov 2020 01:19:54 +0100
Subject: [PATCH] cmake: link ast, resources parser as static libraries

Signed-off-by: Romain Naour <romain.naour@gmail.com>
---
 CMakeLists.txt           | 2 +-
 resources/CMakeLists.txt | 2 +-
 src/arch/CMakeLists.txt  | 8 ++++----
 src/ast/CMakeLists.txt   | 2 +-
 4 files changed, 7 insertions(+), 7 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index d732d23..4ebd3ce 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -91,7 +91,7 @@ find_package(FLEX REQUIRED)
 bison_target(bison_parser src/parser.yy ${CMAKE_BINARY_DIR}/parser.tab.cc VERBOSE)
 flex_target(flex_lexer src/lexer.l ${CMAKE_BINARY_DIR}/lex.yy.cc)
 add_flex_bison_dependency(flex_lexer bison_parser)
-add_library(parser ${BISON_bison_parser_OUTPUTS} ${FLEX_flex_lexer_OUTPUTS})
+add_library(parser STATIC ${BISON_bison_parser_OUTPUTS} ${FLEX_flex_lexer_OUTPUTS})
 target_compile_options(parser PRIVATE "-w")
 target_include_directories(parser PUBLIC src src/ast ${CMAKE_BINARY_DIR})
 
diff --git a/resources/CMakeLists.txt b/resources/CMakeLists.txt
index a95c60a..2b05a68 100644
--- a/resources/CMakeLists.txt
+++ b/resources/CMakeLists.txt
@@ -1,4 +1,4 @@
-add_library(resources headers.cpp)
+add_library(resources STATIC headers.cpp)
 
 target_include_directories(resources PUBLIC ../src)
 
diff --git a/src/arch/CMakeLists.txt b/src/arch/CMakeLists.txt
index a26c1c8..fca9a6b 100644
--- a/src/arch/CMakeLists.txt
+++ b/src/arch/CMakeLists.txt
@@ -1,13 +1,13 @@
 if(CMAKE_SYSTEM_PROCESSOR STREQUAL "aarch64")
-    add_library(arch aarch64.cpp)
+    add_library(arch STATIC aarch64.cpp)
 elseif(CMAKE_SYSTEM_PROCESSOR STREQUAL "ppc64" OR
        CMAKE_SYSTEM_PROCESSOR STREQUAL "ppc64le")
-    add_library(arch ppc64.cpp)
+    add_library(arch STATIC ppc64.cpp)
 elseif(CMAKE_SYSTEM_PROCESSOR STREQUAL "s390" OR
        CMAKE_SYSTEM_PROCESSOR STREQUAL "s390x")
-    add_library(arch s390.cpp)
+    add_library(arch STATIC s390.cpp)
 elseif(CMAKE_SYSTEM_PROCESSOR STREQUAL "x86_64")
-    add_library(arch x86_64.cpp)
+    add_library(arch STATIC x86_64.cpp)
 else()
   message(FATAL_ERROR "Unsupported architecture: ${CMAKE_SYSTEM_PROCESSOR}")
 endif()
diff --git a/src/ast/CMakeLists.txt b/src/ast/CMakeLists.txt
index 649bf0a..477d809 100644
--- a/src/ast/CMakeLists.txt
+++ b/src/ast/CMakeLists.txt
@@ -1,4 +1,4 @@
-add_library(ast
+add_library(ast STATIC
   ast.cpp
   attachpoint_parser.cpp
   codegen_llvm.cpp
-- 
2.25.4

